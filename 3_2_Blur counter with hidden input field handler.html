<!DOCTYPE html>
<html>
<body>
<script>

// You will need to adapt the hidden input field ID (“v_1”) and (“v_2”) to the ID of your variable. 
// If you have existing hidden input fields, you need to adapt (“v_1”) and (“v_2”) to your hidden input field ID that is already in place.

// Counter for the number of times that participants leave the study page
    
// Declaring variables for counting up the number of times participants blur a study page, 
// how long participants left study page overall and a start and end timestamp variable
let counterBlur = 0;
let secondsOutsideWindow = 0;
let startSecondsOutsideWindow = 0;
let endSecondsOutsideWindow = 0;

// Creates a hidden input field that has the id v_1, if hidden input field is already in place, you should delete this part
let hiddenInput1 = document.createElement("input"); 
hiddenInput.setAttribute("type", "hidden"); 
hiddenInput.setAttribute("id", "v_1");
document.body.appendChild(hiddenInput1);

// Creates a hidden input field that has the id v_2, if hidden input field is already in place, you should delete this part
let hiddenInput2 = document.createElement("input"); 
hiddenInput.setAttribute("type", "hidden"); 
hiddenInput.setAttribute("id", "v_2");
document.body.appendChild(hiddenInput2);

// Sending initial values to hidden input fields
document.getElementById("v_1").value = counterBlur;
document.getElementById("v_2").value = secondsOutsideWindow;

// Insert JavaScript code canceling cut, copy, paste commands here

// EventListener counting variable counterBlur if webpage is blurred
window.addEventListener("blur", (event) => {
    counterBlur = counterBlur + 1;

    // Implement the handler for variable counterBlur right here
    document.getElementById("v_1").value = counterBlur;

    // Takes unix timestamp in seconds for blurring of study page
    startSecondsOutsideWindow = Math.floor(Date.now() / 1000);
});

// EventListener that calculates participants’ time outside the study’s page when participants refocus study page
window.addEventListener("focus", (event) => {

    // Takes unix timestamp in seconds for focus of study page
    endSecondsOutsideWindow = Math.floor(Date.now() / 1000);
    if (counterBlur > 0) { // Calculates time difference between leaving and refocus
        secondsOutsideWindow = secondsOutsideWindow +    endSecondsOutsideWindow - startSecondsOutsideWindow;
    }
    if (counterBlur === 0) {
        secondsOutsideWindow = 0;
    }
    
    // Implement the handler for variable secondsOutsideWindow right here    
    document.getElementById("v_2").value = secondsOutsideWindow;

});

</script> 

</body>
